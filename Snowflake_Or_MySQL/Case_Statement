use database "DEMO_DATABASE";

DESCRIBE TABLE PK_CONSUMER_COMPLAINTS;

select * from PK_CONSUMER_COMPLAINTS LIMIT 100; --TOP WORKS IN MYSQL

SELECT DISTINCT * FROM PK_CONSUMER_COMPLAINTS;

select distinct CONSUMER_DISPUTED from PK_CONSUMER_COMPLAINTS;

--SYNTAX : SELECT DISTINCT COL_NAME FROM TABLE_NAME
SELECT DISTINCT PRODUCT_NAME FROM PK_CONSUMER_COMPLAINTS;
SELECT DISTINCT SUB_PRODUCT FROM PK_CONSUMER_COMPLAINTS;

SELECT DISTINCT ISSUE FROM PK_CONSUMER_COMPLAINTS;

select distinct COMPANY from PK_CONSUMER_COMPLAINTS;
SELECT DISTINCT SUBMITTED_VIA  from PK_CONSUMER_COMPLAINTS;

--to select all the columns
--then am filtering rows based on the conditions 
SELECT DATE_RECEIVED, PRODUCT_NAME ,SUB_PRODUCT,ISSUE,
        CASE WHEN SUBMITTED_VIA IN ('Referral','Postal Mail','Email') THEN 'Outbound'
             WHEN SUBMITTED_VIA IN ('Phone','Web') THEN 'Inbound'
             ELSE 'Electronics'
         END AS Submission_Type,
         
         COMPANY,STATE_NAME,ZIP_CODE
FROM PK_CONSUMER_COMPLAINTS;


select *, case
when SUBMITTED_VIA in ('Phone' ,'Web') then 'INBOard',
when SUBMITTED_VIA = 'Fax' then 'Electronic',
else 'outboard'
end as Submission_type
from PK_CONSUMER_COMPLAINTS;

SELECT DISTINCT COMPANY_RESPONSE_TO_CONSUMER FROM PK_CONSUMER_COMPLAINTS;

-----CODE 
select *,
    CASE 
        wHen Product_Name like '%loan%' or Product_Name like '%Loan%' then 'Loan type'--THIS U CAN AVOIUD 
        when Product_Name in ('Bank account or service','Mortgage','Debt collection', 
                              'Credit reporting','Money transfers') then 'service'
        else 'other'
        
    end as Finance_type 
    from PK_CONSUMER_COMPLAINTS;
    
    
    ----- OPTIMIZED CODE
    SELECT *,
               CASE 
	                WHEN LOWER(PRODUCT_NAME) LIKE '%loan' THEN 'Loan'
	                WHEN UPPER(PRODUCT_NAME) IN('BANK ACCOUNT OR SERVICE','MORTGAGE','DEBT CLLECTION','CREDIT CARD','CREDIT REPORTING','MONEY TRANSFERS') THEN 'Service'
	ELSE 'Other'
END AS FINANCE_TYPE
FROM PK_CONSUMER_COMPLAINTS;

select  *,
    case when product_name like '%loan' or product_name like '%Loan' then 'loan'
         when product_name in ('Mortage','Bank account or service then','Credit reporting') then 'Service'
    else 'Others'
    end as finance_type
  from PK_CONSUMER_COMPLAINTS;
  
SELECT *,
        CASE
        WHEN PRODUCT_NAME LIKE '%Loan%' OR PRODUCT_NAME LIKE '%loan%' THEN 'LOAN'
        WHEN PRODUCT_NAME IN ('Bank account or service','Mortgage','Debt collection','Credit card','Credit reporting',
                              'Money transfers','Prepaid card') THEN 'SERVICE'
        ELSE 'OTHER'
        END AS TYPE
FROM PK_CONSUMER_COMPLAINTS;


SELECT *,
	CASE
	WHEN SUB_PRODUCT = 'I do not know' or SUB_PRODUCT is null THEN 'NA'
	WHEN lower(SUB_PRODUCT) LIKE '%loan' THEN 'LOAN'
	WHEN lower(SUB_PRODUCT) LIKE '%card' THEN 'CARD'
	WHEN lower(SUB_PRODUCT) LIKE '%mortage' THEN 'MORTGAGE'
	ELSE SUB_PRODUCT
    END AS SUB_PRODUCT_TYPE
FROM PK_CONSUMER_COMPLAINTS;
